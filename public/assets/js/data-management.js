class DataManagement{constructor(){this.storageKey="admin-panel-data",this.init()}init(){this.initDataStorage(),this.initCRUDOperations(),this.initDataSync(),this.initExportImport()}initDataStorage(){localStorage.getItem(this.storageKey)||this.initializeDefaultData()}initializeDefaultData(){var t={products:[{id:1,name:"Men Black Slim Fit T-shirt",category:"Fashion",price:80,originalPrice:100,stock:784,sold:674,rating:4.1,reviews:143,status:"active",image:"assets/images/product/p-1.png",description:"High quality cotton t-shirt",createdAt:(new Date).toISOString()},{id:2,name:"Olive Green Leather Bag",category:"Hand Bag",price:136,originalPrice:150,stock:450,sold:320,rating:4.3,reviews:89,status:"active",image:"assets/images/product/p-2.png",description:"Premium leather handbag",createdAt:(new Date).toISOString()}],orders:[{id:1,customerName:"John Doe",customerEmail:"john@example.com",total:216,status:"pending",items:2,createdAt:(new Date).toISOString()},{id:2,customerName:"Jane Smith",customerEmail:"jane@example.com",total:80,status:"completed",items:1,createdAt:(new Date).toISOString()}],customers:[{id:1,name:"John Doe",email:"john@example.com",phone:"+1234567890",totalOrders:5,totalSpent:500,status:"active",createdAt:(new Date).toISOString()},{id:2,name:"Jane Smith",email:"jane@example.com",phone:"+1234567891",totalOrders:3,totalSpent:300,status:"active",createdAt:(new Date).toISOString()}],sellers:[{id:1,name:"Fashion Store",email:"fashion@store.com",phone:"+1234567892",products:25,totalSales:15e3,status:"approved",createdAt:(new Date).toISOString()}],categories:[{id:1,name:"Fashion",description:"Clothing and accessories",products:15,status:"active",createdAt:(new Date).toISOString()},{id:2,name:"Electronics",description:"Electronic devices and gadgets",products:8,status:"active",createdAt:(new Date).toISOString()}]};this.saveData(t)}initCRUDOperations(){window.dataManager=this}create(t,e){const a=this.getData();e={id:this.generateId(),...e,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};return a[t]||(a[t]=[]),a[t].push(e),this.saveData(a),this.showNotification(`${t.slice(0,-1)} created successfully!`,"success"),e}read(t,e=null){const a=this.getData();return a[t]?e?a[t].find(t=>t.id===e):a[t]:[]}update(t,e,a){const s=this.getData();if(!s[t])return null;var i=s[t].findIndex(t=>t.id===e);return-1===i?null:(s[t][i]={...s[t][i],...a,updatedAt:(new Date).toISOString()},this.saveData(s),this.showNotification(`${t.slice(0,-1)} updated successfully!`,"success"),s[t][i])}delete(t,e){const a=this.getData();if(!a[t])return!1;var s=a[t].findIndex(t=>t.id===e);return-1!==s&&(a[t].splice(s,1),this.saveData(a),this.showNotification(`${t.slice(0,-1)} deleted successfully!`,"success"),!0)}search(t,e,s=[]){const a=this.read(t),i=e.toLowerCase();return a.filter(a=>0===s.length?Object.values(a).some(t=>"string"==typeof t&&t.toLowerCase().includes(i)):s.some(t=>{const e=a[t];return"string"==typeof e&&e.toLowerCase().includes(i)}))}filter(t,e){const a=this.read(t);return a.filter(a=>Object.entries(e).every(([t,e])=>"string"==typeof e?a[t]?.toLowerCase().includes(e.toLowerCase()):a[t]===e))}initDataSync(){setInterval(()=>{this.syncData()},3e4),document.addEventListener("visibilitychange",()=>{document.hidden||this.syncData()})}syncData(){console.log("Syncing data..."),this.showNotification("Data synced successfully","info")}initExportImport(){this.addExportImportButtons()}addExportImportButtons(){["product-list","orders-list","customer-list","seller-list"].forEach(t=>{const e=document.querySelector(`[data-page="${t}"]`);if(e){const a=e.querySelector(".card-header");a&&!a.querySelector(".export-import-buttons")&&(t=`
                        <div class="export-import-buttons">
                            <button class="btn btn-outline-success btn-sm me-2" onclick="dataManager.exportData('${t.replace("-list","")}')">
                                <i class="bx bx-download me-1"></i> Export
                            </button>
                            <button class="btn btn-outline-primary btn-sm" onclick="dataManager.importData('${t.replace("-list","")}')">
                                <i class="bx bx-upload me-1"></i> Import
                            </button>
                        </div>
                    `,a.insertAdjacentHTML("beforeend",t))}})}exportData(t){var e={type:t,data:this.read(t),exportedAt:(new Date).toISOString(),version:"1.0"},e=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),e=URL.createObjectURL(e);const a=document.createElement("a");a.href=e,a.download=`${t}-export-${(new Date).toISOString().split("T")[0]}.json`,a.click(),URL.revokeObjectURL(e),this.showNotification(`${t} data exported successfully!`,"success")}importData(a){const t=document.createElement("input");t.type="file",t.accept=".json",t.onchange=t=>{t=t.target.files[0];if(t){const e=new FileReader;e.onload=t=>{try{var e=JSON.parse(t.target.result);e.type===a&&e.data?this.importDataToStorage(a,e.data):this.showNotification("Invalid import file format","error")}catch(t){this.showNotification("Error reading import file","error")}},e.readAsText(t)}},t.click()}importDataToStorage(t,e){const a=this.getData();a[t]=e,this.saveData(a),this.showNotification(`${t} data imported successfully!`,"success"),setTimeout(()=>{window.location.reload()},1e3)}getData(){var t=localStorage.getItem(this.storageKey);return t?JSON.parse(t):{}}saveData(t){localStorage.setItem(this.storageKey,JSON.stringify(t))}generateId(){return Date.now()+Math.random().toString(36).substr(2,9)}showNotification(t,e="info"){window.dashboard&&window.dashboard.showNotification?window.dashboard.showNotification(t,e):console.log(`${e.toUpperCase()}: ${t}`)}getStatistics(){const t=this.getData();return{totalProducts:t.products?.length||0,totalOrders:t.orders?.length||0,totalCustomers:t.customers?.length||0,totalSellers:t.sellers?.length||0,totalRevenue:t.orders?.reduce((t,e)=>t+(e.total||0),0)||0,activeProducts:t.products?.filter(t=>"active"===t.status).length||0,pendingOrders:t.orders?.filter(t=>"pending"===t.status).length||0,approvedSellers:t.sellers?.filter(t=>"approved"===t.status).length||0}}validateData(t,e){const a={products:t=>t.name&&t.price&&t.category,orders:t=>t.customerName&&t.customerEmail&&t.total,customers:t=>t.name&&t.email,sellers:t=>t.name&&t.email,categories:t=>t.name};return!a[t]||a[t](e)}}document.addEventListener("DOMContentLoaded",function(){new DataManagement});const dataStyle=document.createElement("style");dataStyle.textContent=`
    .export-import-buttons {
        display: flex;
        gap: 0.5rem;
    }
    
    .data-table {
        width: 100%;
    }
    
    .data-table th,
    .data-table td {
        padding: 0.75rem;
        vertical-align: middle;
    }
    
    .data-table .btn-group {
        display: flex;
        gap: 0.25rem;
    }
`,document.head.appendChild(style);